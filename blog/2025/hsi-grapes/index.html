<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> In-Field Grape Quality Mapping with Illumination-Invariant AI | Ciem Cornelissen </title> <meta name="author" content="Ciem Cornelissen"> <meta name="description" content="Our new robotic system uses domain-adversarial learning to overcome changing sunlight, enabling robust, real-time mapping of grape yield, sugar, and acidity."> <meta name="keywords" content="machine learning, deep learning, precision agriculture, hyperspectral imaging, UAV, computer vision, AI fairness"> <link rel="stylesheet" href="/al-folio_test/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/al-folio_test/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/al-folio_test/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&amp;family=Nunito+Sans:wght@300;400;500;700&amp;display=swap"> <link defer rel="stylesheet" href="/al-folio_test/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/al-folio_test/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/al-folio_test/assets/img/ciem_profile_face.png?16d13380b612d1f9253966d4ddf03d61"> <link rel="stylesheet" href="/al-folio_test/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ciemcornelissen.github.io/al-folio_test/blog/2025/hsi-grapes/"> <script src="/al-folio_test/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/al-folio_test/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio_test/"> <span class="font-weight-bold">Ciem</span> Cornelissen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio_test/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/al-folio_test/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio_test/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio_test/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio_test/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio_test/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">In-Field Grape Quality Mapping with Illumination-Invariant AI</h1> <p class="post-meta"> Created on October 20, 2025 </p> <p class="post-tags"> <a href="/al-folio_test/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/al-folio_test/blog/tag/hyperspectral-imaging"> <i class="fa-solid fa-hashtag fa-sm"></i> hyperspectral-imaging</a>   <a href="/al-folio_test/blog/tag/precision-agriculture"> <i class="fa-solid fa-hashtag fa-sm"></i> precision-agriculture</a>   <a href="/al-folio_test/blog/tag/deep-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> deep-learning</a>   <a href="/al-folio_test/blog/tag/computer-vision"> <i class="fa-solid fa-hashtag fa-sm"></i> computer-vision</a>   <a href="/al-folio_test/blog/tag/robotics"> <i class="fa-solid fa-hashtag fa-sm"></i> robotics</a>   ·   <a href="/al-folio_test/blog/category/research"> <i class="fa-solid fa-tag fa-sm"></i> research</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Hyperspectral imaging is a powerful tool for seeing the invisible qualities of crops, like the sugar content in grapes. But taking this technology from the controlled lab to a real-world vineyard has one massive obstacle: the sun. A model trained on a sunny morning fails on a cloudy afternoon because the changing light completely alters the data.</p> <p>Our latest paper introduces an end-to-end robotic system that tackles this problem. At its core is a novel deep learning framework called the <strong>Light-Invariant Spectral Autoencoder (LISA)</strong>, which learns to see a grape’s intrinsic properties, regardless of the lighting conditions.</p> <p>This post explains the core challenge, how our adversarial AI works, and how we integrated it into a field robot that generates real-time, high-resolution maps of grape yield and quality.</p> <p>We’re thrilled to announce our paper has been accepted to the IEEE Internet of Things Journal in a special issue on Intelligent IoT for Sustainable Agriculture! You can <a href="https://arxiv.org/abs/2510.04864" rel="external nofollow noopener" target="_blank">read the full preprint on arXiv</a> or access the <a href="https://doi.org/10.1109/JIOT.2025.3617805" rel="external nofollow noopener" target="_blank">published version</a>.</p> <hr> <h2 id="the-problem-sunlight-is-a-domain-shift">The Problem: Sunlight is a Domain Shift</h2> <p>Hyperspectral sensors are extremely sensitive. The same grape bunch will produce dramatically different spectral data depending on the time of day, cloud cover, and shadows. This “domain shift” is the primary reason why HSI systems have struggled to move from the lab to reliable field autonomy.</p> <p>First, let’s look at the visual difference. We created a unique dataset by imaging the exact same grape bunches under three distinct lighting conditions. The change is not subtle.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img src="/al-folio_test/assets/img/blog/2025-10-20-hsi-grapes/dataSetICCV.png" class="img-fluid rounded z-depth-1" zoomable="true"> </div> </div> <div class="caption"> The visual appearance of a single grape bunch changes dramatically across our three domains. From left to right: controlled lab lighting, natural morning sun, and natural afternoon sun. </div> <p>This isn’t just a cosmetic effect; it represents a fundamental shift in the data the sensor captures. A standard AI model sees these as three completely different objects. The graph of their spectral signatures makes this problem crystal clear.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img src="/al-folio_test/assets/img/blog/2025-10-20-hsi-grapes/spectralsignatures.png" class="img-fluid rounded z-depth-1" zoomable="true"> </div> </div> <div class="caption"> The plot of the raw spectral data confirms the challenge. Both the intensity and shape of the signature change with illumination, creating a "domain shift" that confuses conventional models and makes robust prediction impossible without a specialized solution. </div> <p>The traditional fix is frequent, manual calibration using a white reference panel. For a robot designed for continuous, autonomous operation, this stop-and-go process is impractical and defeats the purpose of automation. We needed a data-driven solution.</p> <hr> <h2 id="our-solution-learning-to-ignore-the-sun-with-lisa">Our Solution: Learning to Ignore the Sun with LISA</h2> <p>Instead of relying on physical calibration, we designed an AI model that learns illumination-invariance directly from the data. LISA is a <strong>domain-adversarial autoencoder</strong>. Here’s the concept in simple terms:</p> <ol> <li> <strong>A Feature Extractor:</strong> This is the main part of the model. Its job is to look at the raw hyperspectral data and extract a compact, meaningful representation (a latent vector).</li> <li> <strong>Two Competing Goals:</strong> We give this extractor two jobs. <ul> <li> <strong>Task Predictor:</strong> Tries to predict the grape’s quality (Brix and Acidity) from the features. This forces the features to be useful.</li> <li> <strong>Domain Discriminator:</strong> Tries to guess the lighting condition (e.g., “Lab” vs. “Field”) from the same features.</li> </ul> </li> </ol> <p>During training, we reward the Feature Extractor for helping the Task Predictor succeed while simultaneously “fooling” the Domain Discriminator. This adversarial process forces the model to learn a representation that is highly predictive of grape quality but contains no information about the illumination. It learns the grape’s true signature.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img src="/al-folio_test/assets/img/blog/2025-10-20-hsi-grapes/AE.png" class="img-fluid rounded z-depth-1" zoomable="true"> </div> </div> <div class="caption"> The architecture of our Light-Invariant Spectral Autoencoder (LISA). The adversarial process between the Task Predictor and Domain Discriminator forces the shared features (z) to become illumination-invariant. </div> <hr> <h2 id="an-end-to-end-system-for-yield-and-quality">An End-to-End System for Yield and Quality</h2> <p>LISA is the core of our complete, IoT-enabled robotic system. The platform integrates two key analytical modules that run in real-time on the robot’s edge computer:</p> <ol> <li> <strong>Yield Estimation:</strong> A YOLOv11 model detects grape bunches, and a 2D CNN regression model estimates their weight from the hyperspectral data.</li> <li> <strong>Quality Assessment:</strong> Our LISA framework analyzes the pixels within each detected bunch to predict the average Brix and Acidity.</li> </ol> <p>All predictions are fused with GPS data to create georeferenced data points. As the robot moves through the vineyard, it streams this information, building a detailed, spatially-resolved map of both crop quantity and quality.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img src="/al-folio_test/assets/img/blog/2025-10-20-hsi-grapes/IoTsystemArcitecture.png" class="img-fluid rounded z-depth-1" zoomable="true"> </div> </div> <div class="caption"> Our integrated robotic platform during in-field data acquisition. The system combines a mobile base, a robotic arm for sensor positioning, a hyperspectral camera, and GPS. </div> <hr> <h2 id="from-data-points-to-actionable-maps">From Data Points to Actionable Maps</h2> <p>The final output is not just a single prediction, but a comprehensive map that reveals in-field variability. This allows growers to move from manual, sparse sampling to data-driven management.</p> <p>Our system successfully identifies individual bunches and provides granular predictions. In our tests, <strong>the LISA module improved quality prediction generalization by over 20%</strong> compared to baseline models that were not robust to illumination changes. The full pipeline achieved a recall of 0.82 for bunch detection and an R² of 0.76 for weight estimation.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <img src="/al-folio_test/assets/img/blog/2025-10-20-hsi-grapes/exampleScan.png" class="img-fluid rounded z-depth-1" zoomable="true"> </div> </div> <div class="caption"> An example of the system's live output. Each detected bunch is annotated with its ID, estimated weight (W), and predicted quality (Brix and Acidity), ready to be mapped. </div> <hr> <h2 id="what-this-means-for-precision-viticulture">What this means for Precision Viticulture</h2> <ul> <li> <strong>Robust Autonomy:</strong> By solving the illumination problem at the algorithmic level, we reduce the need for impractical hardware or manual calibration steps.</li> <li> <strong>High-Resolution Insights:</strong> The system provides data at the per-bunch level, far more detailed than what is possible with traditional methods.</li> <li> <strong>Actionable Data:</strong> Growers can use these maps for targeted interventions like differential harvesting, zone-specific irrigation, or optimized fertilization.</li> </ul> <p>While there are still steps to take in testing across more varieties and seasons, this work represents a significant move towards truly autonomous, field-deployable HSI systems.</p> <hr> <p><strong>Paper Citation:</strong><br> Cornelissen, C., De Coninck, S., Willekens, A., Leroux, S., &amp; Simoens, P. (2025). In-Field Mapping of Grape Yield and Quality with Illumination-Invariant Deep Learning. <em>IEEE Internet of Things Journal</em>. <a href="https://doi.org/10.1109/JIOT.2025.3617805" rel="external nofollow noopener" target="_blank">https://doi.org/10.1109/JIOT.2025.3617805</a></p> <p><strong>Preprint:</strong> <a href="https://arxiv.org/abs/2510.04864" rel="external nofollow noopener" target="_blank">arXiv:2510.04864</a></p> </div> </article> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Ciem Cornelissen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/al-folio_test/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/al-folio_test/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/al-folio_test/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/al-folio_test/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/al-folio_test/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/al-folio_test/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/al-folio_test/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/al-folio_test/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/al-folio_test/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/al-folio_test/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/al-folio_test/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/al-folio_test/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/al-folio_test/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/al-folio_test/assets/js/search-data.js"></script> <script src="/al-folio_test/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>